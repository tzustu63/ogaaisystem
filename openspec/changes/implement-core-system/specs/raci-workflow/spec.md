## ADDED Requirements

### Requirement: RACI 模板管理
系統 SHALL 管理 RACI 模板，支援預設場景模板與自訂模板。每個模板必須定義 R（Responsible）、A（Accountable）、C（Consulted）、I（Informed）角色。

#### Scenario: 建立 RACI 模板
- **WHEN** 使用者建立新 RACI 模板
- **THEN** 系統要求指定至少一個 A 角色
- **AND** 系統允許指定多個 R、C、I 角色
- **AND** 系統允許儲存為模板供後續使用

#### Scenario: 使用預設模板
- **WHEN** 使用者選擇使用預設場景模板（如「雙聯學制合約簽署」）
- **THEN** 系統自動填入對應的 RACI 角色
- **AND** 系統允許修改模板內容

### Requirement: 可執行工作流定義
系統 SHALL 將 RACI 模板擴充為可執行工作流，包含步驟、每步驟角色權限、SLA、必要附件、逾期升級、條件檢核。

#### Scenario: 定義工作流步驟
- **WHEN** 使用者定義工作流
- **THEN** 系統允許定義多個步驟（如 Draft → Consultation → Approval → Archive）
- **AND** 系統要求為每個步驟定義 R/C/A/I 的操作權限
- **AND** 系統允許設定 SLA（如 C 需在 5 個工作天內會簽）

#### Scenario: 設定必要附件
- **WHEN** 使用者設定工作流必要附件
- **THEN** 系統要求指定每個步驟需要的附件類型
- **AND** 系統在步驟開始前檢查必要附件是否已上傳

#### Scenario: 設定逾期升級規則
- **WHEN** 使用者設定逾期升級規則
- **THEN** 系統允許設定逾期時間閾值
- **AND** 系統允許指定升級通知對象（如國際長/副校長）
- **AND** 系統在逾期時自動發送升級通知

### Requirement: 工作流執行規則
系統 SHALL 執行工作流，包括草案階段、會簽階段、核定階段、歸檔階段的完整流程。

#### Scenario: 草案階段
- **WHEN** R 角色上傳草案
- **THEN** 系統自動通知所有 C 角色進行會簽
- **AND** 系統在工作流中標記狀態為「會簽中」

#### Scenario: 會簽階段
- **WHEN** C 角色進行會簽
- **THEN** 系統允許標記「同意/建議修正/不同意」並附意見
- **AND** 系統顯示會簽進度儀表板（已完成/進行中/逾期）
- **AND** 系統在逾期時自動發送提醒郵件
- **AND** 系統在達到 SLA 閾值時自動升級通知

#### Scenario: 核定階段
- **WHEN** A 角色嘗試完成核定
- **THEN** 系統檢查所有 C 都已完成會簽
- **AND** 系統檢查必要附件已齊備
- **AND** 系統檢查若有「不同意」意見，需 R 回應處理
- **AND** 系統允許 A 「核定/退回修正」

#### Scenario: 歸檔階段
- **WHEN** 工作流完成
- **THEN** 系統自動歸檔至知識庫
- **AND** I 角色收到完成通知
- **AND** 系統生成完整稽核軌跡報告

### Requirement: 稽核軌跡記錄
系統 SHALL 記錄工作流的所有操作，包括時間戳記、操作人員、操作類型、修改前後內容對比、IP位址。

#### Scenario: 記錄操作
- **WHEN** 工作流中發生任何操作（建立/修正/會簽/核定/退回）
- **THEN** 系統自動記錄時間戳記與操作人員
- **AND** 系統記錄操作類型與修改內容
- **AND** 系統記錄修改前後內容對比（如有）
- **AND** 系統記錄 IP 位址（選配）

#### Scenario: 查詢稽核軌跡
- **WHEN** 使用者查詢工作流稽核軌跡
- **THEN** 系統顯示完整的操作歷史
- **AND** 系統支援依時間、人員、操作類型篩選
- **AND** 系統允許匯出稽核報告

